{% extends "base.html" %}
{% load static %}

{% block mtitle %}Drive{% endblock %}
{% block head %}
<link rel="stylesheet" type="text/css" href={% static 'css/dropzone-basic.css' %}>
<link rel="stylesheet" type="text/css" href={% static 'css/dropzone-custom.css' %}>
<script src="{% static 'js/dropzone.js' %}"></script>
<script>
Dropzone.options.driveDropzone = {
  maxFilesize: 4096,
  createImageThumbnails: false,
  headers: {"Dropzone-Identifier": "driveDropzone"},
}
</script>
{% endblock %}

{% block content %}
<div class="row">
  <div class="col-md-4">
  <h2 class="page-header">Drive <small>beta</small></h2>
    <p>Usage: {{ usage|filesizeformat }}</p>
    <form role="form" action="." method="post" class="dropzone" id="driveDropzone" enctype="multipart/form-data">
      {% csrf_token %}
      <div class="fallback">
        <div class="form-group">
          {{ form.file.label_tag }}
          {{ form.file.errors }}
          {{ form.file }}
        </div>
        <input type="submit" value="Upload" class="btn btn-default">
        <p></p>
      </div>
    </form>
  </div>
  <div class="col-md-8" style="margin-top:50px;">
    <form method="post">
      {% csrf_token %}
      <table class="table table-hover">
        {% for file in files %}
        <tr>
          <td>{{ file.as_link }}</td>
	  <td class="text-right hidden-xs"><small>{{ file.file.size|filesizeformat }}</small></td>
	  <td class="text-right hidden-xs"><small>{{ file.created_at|date:"Y/m/d H:i:s" }}</small></td>
	  <td class="text-right"><button type="submit" onclick="return confirm('Are you sure you want to delete the following file?\n{{ file.filename }}')" class="close" formaction="{% url 'drive-delete' file.id %}"><span aria-hidden="true">&times;</span></button></td>
        </tr>
        {% empty %}
        <tr><td>You don't have any files.</td></tr>
	{% endfor %}
      </table>
    </form>
  </div>
</div>
{% endblock %}
