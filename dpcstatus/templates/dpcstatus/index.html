{% extends 'base.html' %}

{% block mtitle %}3D Printer Status{% endblock %}

{% block content %}
<div class="row">
<div class="col-md-6" id="status-block">
  {% include 'dpcstatus/pretty-status.html' %}
</div>
{% if not ERROR %}
<div class="col-md-6">
<h3>Details</h3>
<div class="well monospaced">
<p>{% for c in STATUS.0.message %}{% if c == '|' %}</p><p>{% else %}{{ c }}{% endif %}{% endfor %}</p>
</div>
</div>
{% endif %}
</div>


{% if ERROR %}
<h3>Traceback</h3>
<pre>
{{ ERROR.rstrip }}
</pre>
{% else %}
<h3>Log</h3>
<div class="well no-gradient monospaced">
  <table>
    {% for stdout in STDOUT %}
    <tr>
      <td style="padding-right:10px;" class="hidden-xs hidden-sm hidden-md">{{ stdout.time }}</td>
      <td>{{ stdout.message }}</td>
    </tr>
    {% endfor %}
  </table>
</div>
<h3>Exceptions</h3>
<div class="well no-gradient monospaced">
  <table>
  {% for exception in EXCEPTION %}
    <tr>
      <td class="hidden-xs hidden-sm hidden-md">{{ exception.time }}</td>
      <td>{{ exception.message }}</td>
    </tr>
    {% empty %}
    <tr><td>None.</td></tr>
    {% endfor %}
  </table>
</div>
{% endif %}
{% endblock %}

{% block script %}
{% if not ERROR %}
<script>
setInterval(
  function() {
    $('#status-block').load('{% url "dpcstatus:status-block" %}');
  },
  3000
);
</script>
{% endif %}
{% endblock %}
